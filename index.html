// index.html의 fetch 부분:
document.getElementById('reservation-form').addEventListener('submit', async function (e) {
   e.preventDefault();
   
   const formData = {
       name: document.getElementById('name').value,
       studentId: document.getElementById('student-id').value,
       email: document.getElementById('email').value,
       date: document.getElementById('date').value,
       roomType: document.getElementById('room-type').value,
       floor: document.getElementById('floor')?.value || "",
       seat: document.getElementById('seat').value,
       timeSlot: document.getElementById('time-slot').value
   };

   if (formData.roomType === 'study' && !formData.seat) {
       alert('좌석을 선택해주세요!');
       return;
   }

   try {
       const response = await fetch("/api/notion", {
           method: "POST",
           headers: {
               "Content-Type": "application/json",
               "Accept": "application/json"
           },
           body: JSON.stringify({
               parent: { database_id: "18f137a305b880bda156dcddbd9d0734" },
               properties: {
                   "이름": { title: [{ text: { content: formData.name } }] },
                   "학번": { rich_text: [{ text: { content: formData.studentId } }] },
                   "이메일": { email: formData.email },
                   "예약 날짜": { date: { start: formData.date } },
                   "공간 유형": { select: { name: formData.roomType } },
                   "층 선택": { rich_text: [{ text: { content: formData.floor } }] },
                   "좌석 번호": { number: parseInt(formData.seat) },
                   "예약 시간": { select: { name: formData.timeSlot } }
               }
           })
       });

       if (response.ok) {
           document.getElementById('confirmation').classList.remove('d-none');
           this.reset();
           fetchReservedSeats();
       } else {
           throw new Error('예약 실패');
       }
   } catch (error) {
       console.error('예약 오류:', error);
       alert("예약 중 오류가 발생했습니다. 다시 시도해주세요.");
   }
});